<%- include('../partes/header') %>
  <div class="container mt-5">
  <h1 class="mb-4">Panel de Administración</h1>

  <div class="mb-4">
    <a href="/admin/crearJuego" class="btn btn-success me-2">Agregar Nuevo Juego</a>
    <a href="/admin/crearGiftCard" class="btn btn-success me-2">Agregar Nueva GiftCard</a>
    <a href="/admin/panelVentas" class="btn btn-primary me-2">Ver Ventas</a>
    <a href="/logout" class="btn btn-danger">Cerrar Sesión</a>
  </div>


  <h2 class="mt-5">Juegos</h2>
  <table class="table table-striped table-bordered align-middle">
    <thead class="table-dark text-center">
      <tr>
        <th>Nombre</th>
        <th>Precio</th>
        <th>Stock</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <% juegos.forEach(juego => { %>
        <tr>
          <td><%= juego.nombre %></td>
          <td class="text-end">$<%= juego.precio.toFixed(2) %></td>
          <td class="text-center"><%= juego.stock %></td>
          <td class="text-center">
            <span class="badge <%= juego.activo ? 'bg-success' : 'bg-secondary' %>">
              <%= juego.activo ? 'Activo' : 'Inactivo' %>
            </span>
          </td>
          <td class="text-center">
            <a href="/admin/editarJuego/<%= juego.id %>" class="btn btn-sm btn-outline-primary me-1">Editar</a>
            <% if (juego.activo) { %>
              <button class="btn btn-sm btn-outline-danger"
                      onclick="cambiarEstadoJuego(<%= juego.id %>, false)">
                Desactivar
              </button>
            <% } else { %>
              <button class="btn btn-sm btn-outline-success"
                      onclick="cambiarEstadoJuego(<%= juego.id %>, true)">
                Reactivar
              </button>
            <% } %>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <h2 class="mt-5">GiftCards</h2>
  <table class="table table-striped table-bordered align-middle">
    <thead class="table-dark text-center">
      <tr>
        <th>Nombre</th>
        <th>Precio</th>
        <th>Stock</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <% if (giftcards && giftcards.length) { %>
        <% giftcards.forEach(giftcard => { %>
          <tr>
            <td><%= giftcard.nombre %></td>
            <td class="text-end">$<%= giftcard.precio.toFixed(2) %></td>
            <td class="text-center"><%= giftcard.stock %></td>
            <td class="text-center">
              <span class="badge <%= giftcard.activo ? 'bg-success' : 'bg-secondary' %>">
                <%= giftcard.activo ? 'Activo' : 'Inactivo' %>
              </span>
            </td>
            <td class="text-center">
              <a href="/admin/editarGiftCard/<%= giftcard.id %>" class="btn btn-sm btn-outline-primary me-1">Editar</a>
              <% if (giftcard.activo) { %>
                <button class="btn btn-sm btn-outline-danger"
                        onclick="cambiarEstadoGiftCard(<%= giftcard.id %>, false)">
                  Desactivar
                </button>
              <% } else { %>
                <button class="btn btn-sm btn-outline-success"
                        onclick="cambiarEstadoGiftCard(<%= giftcard.id %>, true)">
                  Reactivar
                </button>
              <% } %>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="5" class="text-center text-muted">No hay GiftCards disponibles</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>



  <script type="module">
    import { crearControladorEstado } from '/js/controladorTokenProductos.js';
    const token = '<%= token %>';
    const controlador = crearControladorEstado(token);
    window.cambiarEstadoJuego = controlador.cambiarEstadoJuego;
    window.cambiarEstadoGiftCard = controlador.cambiarEstadoGiftCard;
  </script>
</div>


<%- include('../partes/footer') %>
